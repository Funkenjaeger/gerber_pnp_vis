# gerber_pnp_vis
## Manual pick-n-place visualization tool
### Overview
The purpose of this tool is to facilitate the process of manual SMD parts placement on a PCB.  The goal is to allow the user to populate a board with a minimal amount of clicking, **no** manual cross-referencing, and without reliance on the presence or legibility of silkscreen markings.

The tool renders a realistic representation of the bare PCB and a filtered parts list showing only the SMD parts which go on the currently visible side of the board.  When any part is selected in the list, the location of all instances of that part are highlighted directly on the board.

![Image](https://user-images.githubusercontent.com/24237058/99197281-8dd73600-275f-11eb-93c6-27b2d7d8e8eb.png)

The tool directly consumes files generated by the CAM processor of Eagle EDA tool (now Fusion 360 Electronics), similar or identical to the files which would be sent to a PCB fab house.  Gerber files are used to render a realistic representation of the bare PCB.  Bill of materials (BOM) and pick-n-place files are used to determine what parts are on either side of the board, and their locations. 

### Installation
This tool is written in Python 3 and depends on the following libraries.  
-pcb-tools (https://github.com/curtacircuitos/pcb-tools - please follow their posted instructions to install!)
-pycairo (this is not listed as a dependency for pcb-tools, but I've been unable to run without it on Win10)
-PySide2
-wheel
-pandas

Note that as of November 2020, there is an outstanding issue with NumPy (1.19.4) in Windows 10.  As a workaround, it is sufficient to downgrade numpy to 1.19.3 (e.g. pip install numpy==1.19.3)

#### Recommended installation process:
1. It's recommended (though not mandatory) to create a clean virtual environment to start with.  In Windows command line, this looks like:
 * `python -m venv <name_of_your_venv>`
 * `<name_of_your_venv>\Scripts\activate`

2. From there, install the pcb-tools library from https://github.com/curtacircuitos/pcb-tools.  I recommend following their posted instructions in the github project readme to install - but as of 11/18/2020, the sequence that has worked for me is as follows:
Clone the pcb-tools repo, go to the target directory (e.g. pcb-tools or pcb-tools-master) and run:
  * `pip install -r requirements.txt`
  * `pip install -e .`

3. Next, you need to bring in one minor change to pcb-tools to make it work (until/unless the change ever gets merged to master) - two options:
 * If you have git installed - from the pcb-tools directory, run:
   * `git fetch https://github.com/ingobecker/pcb-tools`
   * `git cherry-pick e032c365696956752a1020b50c398ac101cac1d0`
 * If you don't have git:
   * manually edit ./gerber/render/cairo_backend.py to incorporate the following small change: https://github.com/curtacircuitos/pcb-tools/pull/165/commits/e032c365696956752a1020b50c398ac101cac1d0

4. Finally, go to the directory where you cloned this project (e.g. gerber_pnp_vis or gerber_pnp_vis-master) and run:
  * `pip install -r requirements.txt`

### Use
#### Generating CAM files
At present, the tool expects a certain directory structure and format settings for the CAM outputs.  Use the provided CAM Processor file 'gerber_pnp_vis.cam' in Eagle / Fusion to ensure the right format.  
![Image](https://user-images.githubusercontent.com/24237058/99197512-fa9f0000-2760-11eb-8658-3f71fd464ff0.PNG)

#### Tool operation
Once you've generated the correct CAM Outputs for your PCB design, launch the tool by running *python parse_assembly.py*, then select *File > Process Gerbers*.  You need to point it to the "CAMOutputs" directory that was generated by the CAM processor.
Click any part in the list to highlight on the board.  Where there are multiples of the same part number on the board, clicking the top-level part in the list will highlight all of them - but you are free to drill down to highlight individual parts by reference designator if you wish.
The *View Side* menu allows you to flip the view to the front or back side of the board.  The parts list updates accordingly, showing only the parts applicable to the currently visible side.

### Potential future enhancements
* More flexibility with regard to input file formats
  * Imperial vs. Metric
  * CSV vs TXT for BOM/PNP files
  * Support files from other EDA tools
* Visualize component orientation

### Parting thoughts
I am not professional developer (much less a Python developer), so I'm sure my code is awful.  I welcome any contributions to make this tool better.
